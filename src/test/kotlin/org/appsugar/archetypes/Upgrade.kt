package org.appsugar.archetypes

import org.springframework.http.HttpEntity
import org.springframework.http.HttpHeaders
import org.springframework.http.HttpMethod
import org.springframework.web.client.RestTemplate
import java.util.*


fun main(args: Array<String>) {
    var iccidList = "89860618050011606787,89860618050011606795,89860618050011606704,89860618050011606738,89860618050011606761,89860618050011606753,89860618050011606720,89860618050011606696,89860618050011606670,89860618050011606571,89860618050011606662,89860618050011606605,89860618050011606639,89860618050011606514,89860618050011606548,89860618050011606480,89860618050011606456,89860618050011606423,89860618050011606647,89860618050011606399,89860618050011606613,89860618050011606589,89860618050011606803,89860618050011606365,89860618050011606555,89860618050011606779,89860618050011606688,89860618050011606621,89860618050011606746,89860618050011606522,89860618050011606712,89860618050011606506,89860618050011606654,89860618050011606530,89860618050011606332,89860618050011606597,89860618050011606563,89860618050011606472,89860618050011606449,89860618050011606498,89860618050011606415,89860618050011606464,89860618050011606407,89860618050011606431,89860618050011606381,89860618050011606357,89860618050011606373,89860618050011606324,89860618050011606282,89860618050011606340,89860618050011606308,89860618050011606316,89860618050011606191,89860618050011606258,89860618050011606225,89860618050011606274,89860618050011606266,89860618050011606167,89860618050011606290,89860618050011605938,89860618050011606159,89860618050011605862,89860618050011606241,89860618050011605870,89860618050011606142,89860618050011606027,89860618050011605946,89860618050011606118,89860618050011605847,89860618050011606100,89860618050011605854,89860618050011605896,89860618050011606043,89860618050011606175,89860618050011605912,89860618050011606035,89860618050011605953,89860618050011606134,89860618050011605979,89860618050011605813,89860618050011605888,89860618050011606001,89860618050011606233,89860618050011606209,89860618050011605821,89860618050011606092,89860618050011606076,89860618050011606217,89860618050011606126,89860618050011605904,89860618050011606050,89860618050011606084,89860618050011605920,89860618050011605839,89860618050011606183,89860618050011605961,89860618050011606019,89860618050011606068,89860618050011605987,89860618050011605995,89860617060075547687,89860617060075547380,89860617060075547539,89860617060075547646,89860617060075547679,89860617060075547711,89860617060075547653,89860617060075547620,89860617060075547505,89860617060075547596,89860617060075547471,89860617060075547463,89860617060075547562,89860617060075547448,89860617060075547612,89860617060075547497,89860617060075547737,89860617060075547588,89860617060075547521,89860617060075547554,89860617060075547703,89860617060075547414,89860617060075547356,89860617060075547323,89860617060075547729,89860617060075547638,89860617060075547661,89860617060075547604,89860617060075547141,89860617060075547695,89860617060075547281,89860617060075547406,89860617060075547422,89860617060075547570,89860617060075547513,89860617060075547364,89860617060075547224,89860617060075547489,89860617060075547547,89860617060075547349,89860617060075547315,89860617060075547166,89860617060075547372,89860617060075547430,89860617060075547331,89860617060075547455,89860617060075547257,89860617060075547299,89860617060075547398,89860617060075547133,89860617060075547190,89860617060075547307,89860617060075547109,89860617060075547265,89860617060075547232,89860617060075547208,89860617060075547174,89860617060075547273,89860617060075547000,89860617060075547034,89860617060075547240,89860617060075547182,89860617060075546978,89860617060075547125,89860617060075547216,89860617060075547117,89860617060075547158,89860617060075547075,89860617060075547067,89860617060075547091,89860617060075546945,89860617060075547083,89860617060075547026,89860617060075547059,89860617060075547042,89860617060075546960,89860617060075546788,89860617060075546846,89860617060075546812,89860617060075546994,89860617060075546937,89860617060075547018,89860617060075546903,89860617060075546721,89860617060075546754,89860617060075546952,89860617060075546879,89860617060075546986,89860617060075546663,89860617060075546515,89860617060075546630,89860617060075546549,89860617060075546481,89860617060075546572,89860617060075546697,89860617060075546606,89860617060075546457,89860617060075546929,89860617060075546911,89860617060075546861,89860617060075546895,89860617060075546887,89860617060075546838,89860617060075546796,89860617060075546820,89860617060075546853,89860617060075546416,89860617060075546804,89860617060075546002,89860617060075546507,89860617060075546291,89860617060075546390,89860617060075546689,89860617060075546770,89860617060075546655,89860617060075546333,89860617060075546440,89860617060075546275,89860617060075546713,89860617060075546747,89860617060075546424,89860617060075546622,89860617060075546531,89860617060075546598,89860617060075546267,89860617060075546366,89860617060075546309,89860617060075546242,89860617060075546150,89860617060075546473,89860617060075546069,89860617060075546564,89860617060075546218,89860617060075546382,89860617060075546325,89860617060075546358,89860617060075546127,89860617060075546093,89860617060075546184,89860617060075546234,89860617060075546036,89860617060075546762,89860617060075546739,89860617060075546671,89860617060075546705,89860617060075546648,89860617060075546580,89860617060075546614,89860617060075546499,89860617060075546523,89860617060075545947,89860617060075546556,89860617060075546465,89860617060075545970,89860617060075546200,89860617060075546085,89860617060075546143,89860617060075545889,89860617060075545855,89860617060075545913,89860617060075546432,89860617060075546408,89860617060075545996,89860617060075545798,89860617060075546374,89860617060075545822,89860617060075546176,89860617060075546028,89860617060075546119,89860617060075545962,89860617060075546051,89860617060075546341,89860617060075545707,89860617060075545905,89860617060075546168,89860617060075545764,89860617060075545939,89860617060075545731,89860617060075546259,89860617060075546317,89860617060075546226,89860617060075546283,89860617060075546192,89860617060075545871,89860617060075546135,89860617060075545814,89860617060075545848,89860617060075546077,89860617060075545780,89860617060075545632,89860617060075545723,89860617060075545756,89860617060075546010,89860617060075545665,89860617060075545699,89860617060075545988,89860617060075546101,89860617060075546044,89860617060075545673,89860617060075545640,89860617060075545574,89860617060075545608,89860617060075545954,89860617060075545897,89860617060075545921,89860617060075545541,89860617060075545863,89860617060075545830,89860617060075545616,89860617060075545806,89860617060075545582,89860617060075545772,89860617060075545517,89860617060075545749,89860617060075545483,89860617060075545715,89860617060075545681,89860617060075545624,89860617060075545657,89860617060075545566,89860617060075545590,89860617060075545459,89860617060075545533,89860617060075545558,89860617060075545426,89860617060075545509,89860617060075545491,89860617060075545442,89860617060075545525,89860617060075545475,89860617060075545467,89860617060075545434,89860617060075545400,89860617060075545418,89860617060075545392,89860617060075545343,89860617060075545376,89860617060075545384,89860617060075545350,89860617060075545368,89860617060075545319,89860617060075545335,89860617060075545327,89860617060075545301,89860617060075545269,89860617060075545251,89860617060075545293,89860617060075545285,89860617060075545277,89860617060075545160,89860617060075545194,89860617060075545103,89860617060075545228,89860617060075545137,89860617060075545046,89860617060075545244,89860617060075545210,89860617060075545079,89860617060075545129,89860617060075545186,89860617060075545012,89860617060075544957,89860617060075545152,89860617060075544981,89860617060075544833,89860617060075544924,89860617060075544890,89860617060075545236,89860617060075545178,89860617060075544866,89860617060075544809,89860617060075545202,89860617060075545145,89860617060075544775,89860617060075544742,89860617060075544650,89860617060075545095,89860617060075545061,89860617060075544718,89860617060075545004,89860617060075544684,89860617060075544940,89860617060075545038,89860617060075545111,89860617060075544627,89860617060075544569,89860617060075544973,89860617060075544734,89860617060075544858,89860617060075544593,89860617060075545087,89860617060075544882,89860617060075544916,89860617060075545053,89860617060075544825,89860617060075545020,89860617060075544536,89860617060075544767,89860617060075544791,89860617060075544999,89860617060075544700,89860617060075544502,89860617060075544643,89860617060075544965,89860617060075544478,89860617060075544676,89860617060075544445,89860617060075544411,89860617060075544387,89860617060075544619,89860617060075544353,89860617060075544460,89860617060075544585,89860617060075544296,89860617060075544494,89860617060075544528,89860617060075544551,89860617060075544403,89860617060075544437,89860617060075544320,89860617060075544379,89860617060075544346,89860617060075544908,89860617060075544577,89860617060075544544,89860617060075544692,89860617060075544262,89860617060075544361,89860617060075544874,89860617060075544429,89860617060075544312,89860617060075544395,89860617060075544338,89860617060075544007,89860617060075544932,89860617060075544064,89860617060075544239,89860617060075544221,89860617060075544189,89860617060075544254,89860617060075544205,89860617060075544288,89860617060075544197,89860617060075544171,89860617060075544213,89860617060075544817,89860617060075544163,89860617060075544130,89860617060075544122,89860617060075544841,89860617060075544783,89860617060075544635,89860617060075544106,89860617060075544726,89860617060075544452,89860617060075544601,89860617060075544510,89860617060075544759,89860617060075544668,89860617060075544486,89860617060075544015,89860617060075544049,89860617060075544072,89860617060075544247,89860617060075544148,89860617060075543991,89860617060075544304,89860617060075544056,89860617060075544270,89860617060075544155,89860617060075543975,89860617060075543983,89860617060075544031,89860617060075544098,89860617060075544114,89860617060075543959,89860617060075544023,89860617060075544080,89860617060075543942,89860617060075543967,89860617060075543934,89860617060075543892,89860617060075543926,89860617060075543900,89860617060075543868,89860617060075543835,89860617060075543918,89860617060075543850,89860617060075543793,89860617060075543876,89860617060075543884,89860617060075543801,89860617060075543827,89860617060075543843,89860617060075543819,89860617060075543785,89860617060075543751,89860617060075543777,89860617060075543769,89860617060075543728,89860617060075543744,89860617060075543694,89860617060075543710,89860617060075543686,89860617060075543652,89860617060075543736,89860617060075543660,89860617060075543629,89860617060075543702,89860617060075543611,89860617060075543645,89860617060075543595,89860617060075543678,89860617060075543561,89860617060075543587,89860617060075543553,89860617060075543520,89860617060075543637,89860617060075543603,89860617060075543538,89860617060075543488,89860617060075543512,89860617060075543546,89860617060075543504,89860617060075543579,89860617060075543496,89860617060075543470,89860617060075543454,89860617060075543413,89860617060075543447,89860617060075543389,89860617060075543397,89860617060075543421,89860617060075543405,89860617060075543462,89860617060075543439,89860617060075543355,89860617060075543322,89860617060075543371,89860617060075543298,89860617060075543348,89860617060075543280,89860617060075543314,89860617060075543363,89860617060075543256,89860617060075543264,89860617060075543306,89860617060075543330,89860617060075543223,89860617060075543249,89860617060075543272,89860617060075543215,89860617060075543207,89860617060075543231,89860617060075543173,89860617060075543181,89860617060075543140,89860617060075543116,89860617060075543165,89860617060075543199,89860617060075543132,89860617060075543082,89860617060075543108,89860617060075543074,89860617060075543157,89860617060075543041,89860617060075543058,89860617060075543017,89860617060075543124,89860617060075543066,89860617060075543090,89860617060075543033,89860617060075542969,89860617060075543025,89860617060075542993,89860617060075543009,89860617060075542936,89860617060075542985,89860617060075542951,89860617060075542902,89860617060075542928,89860617060075542894,89860617060075542860,89860617060075542977,89860617060075542944,89860617060075542910,89860617060075542878,89860617060075542886,89860617060075542845,89860617060075542811,89860617060075542837,89860617060075542787,89860617060075542746,89860617060075542779,89860617060075542803,89860617060075542852,89860617060075542795,89860617060075542761,89860617060075542753,89860617060075542829,89860617060062095690,89860617060062095666,89860617060062095674,89860617060062095633,89860617060062095708,89860617060062095682,89860617060062095542,89860617060062095609,89860617060062095641,89860617060062095658,89860617060062095625,89860617060062095575,89860617060062095591,89860617060062095476,89860617060062095500,89860617060062095484,89860617060062095567,89860617060062095518,89860617060062095534,89860617060062095419,89860617060062095443,89860617060062095385,89860617060062095351,89860617060062095617,89860617060062095468,89860617060062095294,89860617060062095559,89860617060062095229,89860617060062095393,89860617060062095278,89860617060062095526,89860617060062095328,89860617060062095450,89860617060062095310,89860617060062095492,89860617060062095435,89860617060062095245,89860617060062095252,89860617060062095369,89860617060062095583,89860617060062095427,89860617060062095260,89860617060062095286,89860617060062095401,89860617060062095344,89860617060062095377,89860617060062095302,89860617060062095237,89860617060062095211,89860617060062095336".split(",")
    val template = RestTemplate()
    val msg = Message("#000000,UPDA:HBV000,112.95.227.15,8837,HB-R03CDG-17079-V1.1.2.bin")
    // hezhigang bbece92f-dd80-45b4-a555-26f9e98776dc
    // wagnyunda1022  fb0f638a-2e0e-4187-aa45-6182b70c5b91
    val request = HttpEntity(msg, createHeaders("hezhigang", "bbece92f-dd80-45b4-a555-26f9e98776dc"))
    iccidList.forEach {
        val url = "https://api.10646.cn/rws/api/v1/devices/$it/smsMessages"
        val result = template.exchange(url, HttpMethod.POST, request, String::class.java)
        println("$it     ${result.body}")
        Thread.sleep(500)
    }

}

data class Message(val messageText: String)

fun createHeaders(username: String, password: String): HttpHeaders {
    return object : HttpHeaders() {
        init {
            val auth = "$username:$password"
            val encodedAuth = Base64.getEncoder().encode(
                    auth.toByteArray(Charsets.US_ASCII))
            val authHeader = "Basic " + String(encodedAuth)
            set("Authorization", authHeader)
        }
    }
}